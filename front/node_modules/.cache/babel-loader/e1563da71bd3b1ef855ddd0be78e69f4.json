{"ast":null,"code":"/**\n * Module requirements.\n */\nvar Polling = require('./polling');\n\nvar inherit = require('component-inherit');\n/**\n * Module exports.\n */\n\n\nmodule.exports = JSONPPolling;\n/**\n * Cached regular expressions.\n */\n\nvar rNewline = /\\n/g;\nvar rEscapedNewline = /\\\\n/g;\n/**\n * Global JSONP callbacks.\n */\n\nvar callbacks;\n/**\n * Noop.\n */\n\nfunction empty() {}\n/**\n * Until https://github.com/tc39/proposal-global is shipped.\n */\n\n\nfunction glob() {\n  return typeof self !== 'undefined' ? self : typeof window !== 'undefined' ? window : typeof global !== 'undefined' ? global : {};\n}\n/**\n * JSONP Polling constructor.\n *\n * @param {Object} opts.\n * @api public\n */\n\n\nfunction JSONPPolling(opts) {\n  Polling.call(this, opts);\n  this.query = this.query || {}; // define global callbacks array if not present\n  // we do this here (lazily) to avoid unneeded global pollution\n\n  if (!callbacks) {\n    // we need to consider multiple engines in the same page\n    var global = glob();\n    callbacks = global.___eio = global.___eio || [];\n  } // callback identifier\n\n\n  this.index = callbacks.length; // add callback to jsonp global\n\n  var self = this;\n  callbacks.push(function (msg) {\n    self.onData(msg);\n  }); // append to query string\n\n  this.query.j = this.index; // prevent spurious errors from being emitted when the window is unloaded\n\n  if (typeof addEventListener === 'function') {\n    addEventListener('beforeunload', function () {\n      if (self.script) self.script.onerror = empty;\n    }, false);\n  }\n}\n/**\n * Inherits from Polling.\n */\n\n\ninherit(JSONPPolling, Polling);\n/*\n * JSONP only supports binary as base64 encoded strings\n */\n\nJSONPPolling.prototype.supportsBinary = false;\n/**\n * Closes the socket.\n *\n * @api private\n */\n\nJSONPPolling.prototype.doClose = function () {\n  if (this.script) {\n    this.script.parentNode.removeChild(this.script);\n    this.script = null;\n  }\n\n  if (this.form) {\n    this.form.parentNode.removeChild(this.form);\n    this.form = null;\n    this.iframe = null;\n  }\n\n  Polling.prototype.doClose.call(this);\n};\n/**\n * Starts a poll cycle.\n *\n * @api private\n */\n\n\nJSONPPolling.prototype.doPoll = function () {\n  var self = this;\n  var script = document.createElement('script');\n\n  if (this.script) {\n    this.script.parentNode.removeChild(this.script);\n    this.script = null;\n  }\n\n  script.async = true;\n  script.src = this.uri();\n\n  script.onerror = function (e) {\n    self.onError('jsonp poll error', e);\n  };\n\n  var insertAt = document.getElementsByTagName('script')[0];\n\n  if (insertAt) {\n    insertAt.parentNode.insertBefore(script, insertAt);\n  } else {\n    (document.head || document.body).appendChild(script);\n  }\n\n  this.script = script;\n  var isUAgecko = 'undefined' !== typeof navigator && /gecko/i.test(navigator.userAgent);\n\n  if (isUAgecko) {\n    setTimeout(function () {\n      var iframe = document.createElement('iframe');\n      document.body.appendChild(iframe);\n      document.body.removeChild(iframe);\n    }, 100);\n  }\n};\n/**\n * Writes with a hidden iframe.\n *\n * @param {String} data to send\n * @param {Function} called upon flush.\n * @api private\n */\n\n\nJSONPPolling.prototype.doWrite = function (data, fn) {\n  var self = this;\n\n  if (!this.form) {\n    var form = document.createElement('form');\n    var area = document.createElement('textarea');\n    var id = this.iframeId = 'eio_iframe_' + this.index;\n    var iframe;\n    form.className = 'socketio';\n    form.style.position = 'absolute';\n    form.style.top = '-1000px';\n    form.style.left = '-1000px';\n    form.target = id;\n    form.method = 'POST';\n    form.setAttribute('accept-charset', 'utf-8');\n    area.name = 'd';\n    form.appendChild(area);\n    document.body.appendChild(form);\n    this.form = form;\n    this.area = area;\n  }\n\n  this.form.action = this.uri();\n\n  function complete() {\n    initIframe();\n    fn();\n  }\n\n  function initIframe() {\n    if (self.iframe) {\n      try {\n        self.form.removeChild(self.iframe);\n      } catch (e) {\n        self.onError('jsonp polling iframe removal error', e);\n      }\n    }\n\n    try {\n      // ie6 dynamic iframes with target=\"\" support (thanks Chris Lambacher)\n      var html = '<iframe src=\"javascript:0\" name=\"' + self.iframeId + '\">';\n      iframe = document.createElement(html);\n    } catch (e) {\n      iframe = document.createElement('iframe');\n      iframe.name = self.iframeId;\n      iframe.src = 'javascript:0';\n    }\n\n    iframe.id = self.iframeId;\n    self.form.appendChild(iframe);\n    self.iframe = iframe;\n  }\n\n  initIframe(); // escape \\n to prevent it from being converted into \\r\\n by some UAs\n  // double escaping is required for escaped new lines because unescaping of new lines can be done safely on server-side\n\n  data = data.replace(rEscapedNewline, '\\\\\\n');\n  this.area.value = data.replace(rNewline, '\\\\n');\n\n  try {\n    this.form.submit();\n  } catch (e) {}\n\n  if (this.iframe.attachEvent) {\n    this.iframe.onreadystatechange = function () {\n      if (self.iframe.readyState === 'complete') {\n        complete();\n      }\n    };\n  } else {\n    this.iframe.onload = complete;\n  }\n};","map":{"version":3,"names":["Polling","require","inherit","module","exports","JSONPPolling","rNewline","rEscapedNewline","callbacks","empty","glob","self","window","global","opts","call","query","___eio","index","length","push","msg","onData","j","addEventListener","script","onerror","prototype","supportsBinary","doClose","parentNode","removeChild","form","iframe","doPoll","document","createElement","async","src","uri","e","onError","insertAt","getElementsByTagName","insertBefore","head","body","appendChild","isUAgecko","navigator","test","userAgent","setTimeout","doWrite","data","fn","area","id","iframeId","className","style","position","top","left","target","method","setAttribute","name","action","complete","initIframe","html","replace","value","submit","attachEvent","onreadystatechange","readyState","onload"],"sources":["C:/Users/Gabriel/Documents/GitHub/Aulas/front/node_modules/engine.io-client/lib/transports/polling-jsonp.js"],"sourcesContent":["/**\n * Module requirements.\n */\n\nvar Polling = require('./polling');\nvar inherit = require('component-inherit');\n\n/**\n * Module exports.\n */\n\nmodule.exports = JSONPPolling;\n\n/**\n * Cached regular expressions.\n */\n\nvar rNewline = /\\n/g;\nvar rEscapedNewline = /\\\\n/g;\n\n/**\n * Global JSONP callbacks.\n */\n\nvar callbacks;\n\n/**\n * Noop.\n */\n\nfunction empty () { }\n\n/**\n * Until https://github.com/tc39/proposal-global is shipped.\n */\nfunction glob () {\n  return typeof self !== 'undefined' ? self\n      : typeof window !== 'undefined' ? window\n      : typeof global !== 'undefined' ? global : {};\n}\n\n/**\n * JSONP Polling constructor.\n *\n * @param {Object} opts.\n * @api public\n */\n\nfunction JSONPPolling (opts) {\n  Polling.call(this, opts);\n\n  this.query = this.query || {};\n\n  // define global callbacks array if not present\n  // we do this here (lazily) to avoid unneeded global pollution\n  if (!callbacks) {\n    // we need to consider multiple engines in the same page\n    var global = glob();\n    callbacks = global.___eio = (global.___eio || []);\n  }\n\n  // callback identifier\n  this.index = callbacks.length;\n\n  // add callback to jsonp global\n  var self = this;\n  callbacks.push(function (msg) {\n    self.onData(msg);\n  });\n\n  // append to query string\n  this.query.j = this.index;\n\n  // prevent spurious errors from being emitted when the window is unloaded\n  if (typeof addEventListener === 'function') {\n    addEventListener('beforeunload', function () {\n      if (self.script) self.script.onerror = empty;\n    }, false);\n  }\n}\n\n/**\n * Inherits from Polling.\n */\n\ninherit(JSONPPolling, Polling);\n\n/*\n * JSONP only supports binary as base64 encoded strings\n */\n\nJSONPPolling.prototype.supportsBinary = false;\n\n/**\n * Closes the socket.\n *\n * @api private\n */\n\nJSONPPolling.prototype.doClose = function () {\n  if (this.script) {\n    this.script.parentNode.removeChild(this.script);\n    this.script = null;\n  }\n\n  if (this.form) {\n    this.form.parentNode.removeChild(this.form);\n    this.form = null;\n    this.iframe = null;\n  }\n\n  Polling.prototype.doClose.call(this);\n};\n\n/**\n * Starts a poll cycle.\n *\n * @api private\n */\n\nJSONPPolling.prototype.doPoll = function () {\n  var self = this;\n  var script = document.createElement('script');\n\n  if (this.script) {\n    this.script.parentNode.removeChild(this.script);\n    this.script = null;\n  }\n\n  script.async = true;\n  script.src = this.uri();\n  script.onerror = function (e) {\n    self.onError('jsonp poll error', e);\n  };\n\n  var insertAt = document.getElementsByTagName('script')[0];\n  if (insertAt) {\n    insertAt.parentNode.insertBefore(script, insertAt);\n  } else {\n    (document.head || document.body).appendChild(script);\n  }\n  this.script = script;\n\n  var isUAgecko = 'undefined' !== typeof navigator && /gecko/i.test(navigator.userAgent);\n\n  if (isUAgecko) {\n    setTimeout(function () {\n      var iframe = document.createElement('iframe');\n      document.body.appendChild(iframe);\n      document.body.removeChild(iframe);\n    }, 100);\n  }\n};\n\n/**\n * Writes with a hidden iframe.\n *\n * @param {String} data to send\n * @param {Function} called upon flush.\n * @api private\n */\n\nJSONPPolling.prototype.doWrite = function (data, fn) {\n  var self = this;\n\n  if (!this.form) {\n    var form = document.createElement('form');\n    var area = document.createElement('textarea');\n    var id = this.iframeId = 'eio_iframe_' + this.index;\n    var iframe;\n\n    form.className = 'socketio';\n    form.style.position = 'absolute';\n    form.style.top = '-1000px';\n    form.style.left = '-1000px';\n    form.target = id;\n    form.method = 'POST';\n    form.setAttribute('accept-charset', 'utf-8');\n    area.name = 'd';\n    form.appendChild(area);\n    document.body.appendChild(form);\n\n    this.form = form;\n    this.area = area;\n  }\n\n  this.form.action = this.uri();\n\n  function complete () {\n    initIframe();\n    fn();\n  }\n\n  function initIframe () {\n    if (self.iframe) {\n      try {\n        self.form.removeChild(self.iframe);\n      } catch (e) {\n        self.onError('jsonp polling iframe removal error', e);\n      }\n    }\n\n    try {\n      // ie6 dynamic iframes with target=\"\" support (thanks Chris Lambacher)\n      var html = '<iframe src=\"javascript:0\" name=\"' + self.iframeId + '\">';\n      iframe = document.createElement(html);\n    } catch (e) {\n      iframe = document.createElement('iframe');\n      iframe.name = self.iframeId;\n      iframe.src = 'javascript:0';\n    }\n\n    iframe.id = self.iframeId;\n\n    self.form.appendChild(iframe);\n    self.iframe = iframe;\n  }\n\n  initIframe();\n\n  // escape \\n to prevent it from being converted into \\r\\n by some UAs\n  // double escaping is required for escaped new lines because unescaping of new lines can be done safely on server-side\n  data = data.replace(rEscapedNewline, '\\\\\\n');\n  this.area.value = data.replace(rNewline, '\\\\n');\n\n  try {\n    this.form.submit();\n  } catch (e) {}\n\n  if (this.iframe.attachEvent) {\n    this.iframe.onreadystatechange = function () {\n      if (self.iframe.readyState === 'complete') {\n        complete();\n      }\n    };\n  } else {\n    this.iframe.onload = complete;\n  }\n};\n"],"mappings":"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"},"metadata":{},"sourceType":"script"}